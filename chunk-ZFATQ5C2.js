import{a as N,b as we}from"./chunk-IN7WPWQK.js";import{a as Ee,b as Ce,d as I,f as P,g as Be,h as De,i as S,j as F}from"./chunk-EMHLBX52.js";import{b as O,c as Me,d as K,e as A,f as xe}from"./chunk-CKPELB7C.js";import{a as J,b as D}from"./chunk-DMSMQKJ4.js";import{h as T}from"./chunk-DJ3JZSNC.js";import{b as z,c as x,e as Y,f as ge,g as be,h as ve,j as _e,k as he,l as ke,m as H,n as Se}from"./chunk-YD42VMBR.js";import{Oa as ye,Pa as B,Qa as k,Va as w,f as q,i as de,k as h,pa as ue,xa as fe}from"./chunk-LAVAPTOJ.js";import{$ as y,Cb as u,Db as _,L,La as s,Mb as pe,Nb as l,Ob as C,Qa as p,Rb as j,Sb as V,Tb as W,Vb as G,Ya as v,a as oe,aa as E,cb as d,cc as f,dc as $,ec as M,gc as ce,i as re,ia as le,j as ae,kb as c,sb as n,tb as i,ub as b,vb as me,wb as se,yb as R}from"./chunk-HDHCGP6B.js";var We=()=>({"min-width":"100%"});function $e(r,e){r&1&&(n(0,"tr")(1,"th"),l(2,"ID"),i(),n(3,"th"),l(4,"Nombre"),i(),n(5,"th"),l(6,"Tel\xE9fono"),i(),n(7,"th"),l(8,"Direcci\xF3n"),i(),n(9,"th"),l(10,"Correo Electr\xF3nico"),i(),n(11,"th",4),l(12,"Acciones"),i()())}function Ue(r,e){if(r&1){let t=R();n(0,"tr",5),u("click",function(m){let a=y(t).$implicit,g=_();return E(g.onRowClick(a,m))}),n(1,"td",6),l(2),f(3,"fallback"),i(),n(4,"td",7),l(5),f(6,"fallback"),i(),n(7,"td",8),l(8),f(9,"fallback"),i(),n(10,"td",9),l(11),f(12,"fallback"),i(),n(13,"td",10),l(14),f(15,"fallback"),i(),n(16,"td",11)(17,"div",12)(18,"p-button",13),u("click",function(m){let a=y(t).$implicit,g=_();return E(g.onEdit(a,m))}),i(),n(19,"p-button",14),u("click",function(m){let a=y(t).$implicit,g=_();return E(g.onDelete(a,m))}),i()()()()}if(r&2){let t=e.$implicit;c("pSelectableRow",t),s(2),C(M(3,6,t.id,"Sin ID")),s(3),C(M(6,9,t.name,"Sin nombre")),s(3),C(M(9,12,t.phone,"Sin tel\xE9fono")),s(3),C(M(12,15,t.address,"Sin direcci\xF3n")),s(3),C(M(15,18,t.mail,"Sin correo"))}}var Q=class r{_list=[];set list(e){this._list=e}action=new le;constructor(){}onRowClick(e,t){t.stopPropagation(),this.action.emit({type:"selected",value:e})}onEdit(e,t){t.stopPropagation(),this.action.emit({type:"edit",value:e})}onDelete(e,t){t.stopPropagation(),this.action.emit({type:"delete",value:e})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=v({type:r,selectors:[["app-bank-table"]],inputs:{list:"list"},outputs:{action:"action"},decls:4,vars:3,consts:[[1,"table-wrapper"],["responsiveLayout","scroll",3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[2,"text-align","center"],[3,"click","pSelectableRow"],["data-label","ID"],["data-label","Nombre"],["data-label","Tel\xE9fono"],["data-label","Direcci\xF3n"],["data-label","Correo"],["data-label","Acciones",2,"text-align","center","white-space","nowrap"],[1,"action-buttons"],["icon","pi pi-pencil","styleClass","p-button-text p-button-edit",3,"click"],["icon","pi pi-trash","styleClass","p-button-text p-button-delete",3,"click"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"p-table",1),d(2,$e,13,0,"ng-template",2)(3,Ue,20,21,"ng-template",3),i()()),t&2&&(s(),c("value",o._list)("tableStyle",G(2,We)))},dependencies:[S,Be,fe,De,k,B,we,h],encapsulation:2})};function ze(r,e){r&1&&(n(0,"small",13),l(1," Campo obligatorio "),i())}function Ye(r,e){r&1&&(n(0,"small",13),l(1," Campo obligatorio "),i())}function He(r,e){r&1&&(n(0,"small",13),l(1," Correo no v\xE1lido "),i())}function Je(r,e){r&1&&(n(0,"small",13),l(1," Campo obligatorio "),i())}var X=class r{constructor(e,t,o,m){this.dialogRef=e;this.appService=t;this.fb=o;this.uiService=m;this.bankForm=this.fb.group({name:["",[x.required,x.minLength(2)]],phone:["",[x.required]],mail:["",[x.email]],address:["",[x.required]]})}bankForm;ngOnInit(){}save(){if(this.bankForm.invalid){this.markAllAsTouched(),this.uiService.showWarn("Formulario inv\xE1lido","Por favor complete todos los campos requeridos correctamente");return}let e=this.bankForm.value;this.appService.bankApiService.addBank(e).subscribe({next:()=>{this.uiService.showSuccess("\xC9xito","Banco guardado correctamente"),this.dialogRef.close({success:!0,value:e})},error:t=>{t?.error?.Message?.includes("ya en uso")?this.uiService.showError("Duplicado","Ya existe un banco con ese nombre."):this.uiService.showError("Error del servidor","No se pudo guardar el banco.")}})}markAllAsTouched(){Object.values(this.bankForm.controls).forEach(e=>{e.markAsTouched({onlySelf:!0})})}static \u0275fac=function(t){return new(t||r)(p(K),p(I),p(ke),p(N))};static \u0275cmp=v({type:r,selectors:[["app-bank-add"]],decls:23,vars:5,consts:[[1,"p-fluid",2,"padding","1rem","min-width","400px","max-width","600px",3,"formGroup"],[1,"p-field"],["for","name"],["id","name","type","text","pInputText","","formControlName","name"],["class","p-error",4,"ngIf"],["for","phone"],["id","phone","type","text","pInputText","","formControlName","phone"],["for","mail"],["id","mail","type","email","pInputText","","formControlName","mail"],["for","address"],["id","address","type","text","pInputText","","formControlName","address"],[2,"text-align","right","margin-top","1.5rem"],["label","Guardar","styleClass","p-button-success",3,"click"],[1,"p-error"]],template:function(t,o){if(t&1&&(n(0,"form",0)(1,"div",1)(2,"label",2),l(3,"Nombre*"),i(),b(4,"input",3),d(5,ze,2,0,"small",4),i(),n(6,"div",1)(7,"label",5),l(8,"Tel\xE9fono*"),i(),b(9,"input",6),d(10,Ye,2,0,"small",4),i(),n(11,"div",1)(12,"label",7),l(13,"Correo electr\xF3nico"),i(),b(14,"input",8),d(15,He,2,0,"small",4),i(),n(16,"div",1)(17,"label",9),l(18,"Direcci\xF3n*"),i(),b(19,"input",10),d(20,Je,2,0,"small",4),i(),n(21,"div",11)(22,"p-button",12),u("click",function(){return o.save()}),i()()()),t&2){let m,a,g,U;c("formGroup",o.bankForm),s(5),c("ngIf",((m=o.bankForm.get("name"))==null?null:m.invalid)&&((m=o.bankForm.get("name"))==null?null:m.touched)),s(5),c("ngIf",((a=o.bankForm.get("phone"))==null?null:a.invalid)&&((a=o.bankForm.get("phone"))==null?null:a.touched)),s(5),c("ngIf",((g=o.bankForm.get("mail"))==null?null:g.invalid)&&((g=o.bankForm.get("mail"))==null?null:g.touched)),s(5),c("ngIf",((U=o.bankForm.get("address"))==null?null:U.invalid)&&((U=o.bankForm.get("address"))==null?null:U.touched))}},dependencies:[h,q,H,ve,z,Y,ge,Se,_e,he,T,k,B,P,O,w,A,S,D,J,F],styles:[".form-container[_ngcontent-%COMP%]{background-color:#fff;color:#000;padding:2rem;border-radius:12px;max-width:600px;margin:2rem auto;box-shadow:0 0 20px #0000001a}.form-field[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:.5rem;color:#000}input[pInputText][_ngcontent-%COMP%], p-dropdown[_ngcontent-%COMP%]{width:100%;border-radius:6px;border:1px solid #ccc;padding:.5rem;background-color:#f9f9f9;color:#000}input[pInputText][_ngcontent-%COMP%]:focus, p-dropdown[_ngcontent-%COMP%]:focus{border-color:#000;box-shadow:0 0 3px #000}.p-error[_ngcontent-%COMP%]{font-size:.85rem;color:#e53935;margin-top:.25rem;display:block}.form-actions[_ngcontent-%COMP%]{text-align:right;margin-top:2rem}.p-button-success[_ngcontent-%COMP%]{background-color:#000!important;border:none;color:#fff;padding:.75rem 2rem;font-weight:700;border-radius:8px;transition:background-color .2s ease-in-out}.p-button-success[_ngcontent-%COMP%]:hover{background-color:#333!important}"]})};var Z=class r{constructor(e,t,o,m){this.ref=e;this.config=t;this.appService=o;this.ui=m}model={id:0,name:"",phone:"",mail:"",address:""};ngOnInit(){this.config.data?.bank&&(this.model=oe({},this.config.data.bank))}save(){this.ui.setLoading(!0),this.appService.bankApiService.updateBank(this.model).subscribe({next:()=>{this.ui.showSuccess("Banco actualizado","Se guardaron correctamente"),this.ref.close({success:!0})},error:e=>{this.ui.showError("Error al guardar","No se pudo actualizar el banco"),console.error("Error al actualizar banco",e)},complete:()=>this.ui.setLoading(!1)})}static \u0275fac=function(t){return new(t||r)(p(K),p(Me),p(I),p(N))};static \u0275cmp=v({type:r,selectors:[["app-bank-edit"]],decls:18,vars:4,consts:[[1,"field"],["pInputText","",3,"ngModelChange","ngModel"],["pButton","","type","button","label","Guardar",3,"click"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"label"),l(2,"Nombre"),i(),n(3,"input",1),W("ngModelChange",function(a){return V(o.model.name,a)||(o.model.name=a),a}),i()(),n(4,"div",0)(5,"label"),l(6,"Tel\xE9fono"),i(),n(7,"input",1),W("ngModelChange",function(a){return V(o.model.phone,a)||(o.model.phone=a),a}),i()(),n(8,"div",0)(9,"label"),l(10,"Correo"),i(),n(11,"input",1),W("ngModelChange",function(a){return V(o.model.mail,a)||(o.model.mail=a),a}),i()(),n(12,"div",0)(13,"label"),l(14,"Direcci\xF3n"),i(),n(15,"input",1),W("ngModelChange",function(a){return V(o.model.address,a)||(o.model.address=a),a}),i()(),b(16,"br"),n(17,"button",2),u("click",function(){return o.save()}),i()),t&2&&(s(3),j("ngModel",o.model.name),s(4),j("ngModel",o.model.phone),s(4),j("ngModel",o.model.mail),s(4),j("ngModel",o.model.address))},dependencies:[T,k,ye,P,O,w,A,S,D,J,F,H,z,Y,be,h],styles:[".form-container[_ngcontent-%COMP%]{background-color:#fff;color:#000;padding:2rem;border-radius:12px;max-width:600px;margin:2rem auto;box-shadow:0 0 20px #0000001a}.form-field[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:.5rem;color:#000}input[pInputText][_ngcontent-%COMP%], p-dropdown[_ngcontent-%COMP%]{width:100%;border-radius:6px;border:1px solid #ccc;padding:.5rem;background-color:#f9f9f9;color:#000}input[pInputText][_ngcontent-%COMP%]:focus, p-dropdown[_ngcontent-%COMP%]:focus{border-color:#000;box-shadow:0 0 3px #000}.p-error[_ngcontent-%COMP%]{font-size:.85rem;color:#e53935;margin-top:.25rem;display:block}.form-actions[_ngcontent-%COMP%]{text-align:right;margin-top:2rem}.p-button-success[_ngcontent-%COMP%]{background-color:#000!important;border:none;color:#fff;padding:.75rem 2rem;font-weight:700;border-radius:8px;transition:background-color .2s ease-in-out}.p-button-success[_ngcontent-%COMP%]:hover{background-color:#333!important}"]})};var Ke=()=>[];function Qe(r,e){r&1&&(me(0),n(1,"div",4),b(2,"p-progressSpinner",5),i(),se())}function Xe(r,e){if(r&1){let t=R();n(0,"app-bank-table",7),f(1,"async"),u("action",function(m){y(t);let a=_(2);return E(a.onListAction(m))}),i()}if(r&2){let t=_(2);c("list",$(1,1,t.banks$)||G(3,Ke))}}function Ze(r,e){if(r&1&&(d(0,Xe,2,4,"app-bank-table",6),f(1,"async")),r&2){let t=_();c("ngIf",!$(1,1,t.loading$))}}var je=class r{constructor(e,t,o,m){this.appService=e;this.dialogService=t;this.confirmationService=o;this.uiService=m;this.loading$=this.uiService.loading$}banks$=new ae([]);loading$;destroy$=new re;ref=null;ngOnInit(){this.loadBanks()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.ref?.close()}loadBanks(){this.uiService.setLoading(!0),this.appService.bankApiService.listBanks().pipe(L(this.destroy$)).subscribe({next:e=>this.banks$.next(e),error:e=>{this.uiService.showError("Error al cargar bancos",e.error?.message||"No se pudo obtener la lista")},complete:()=>this.uiService.setLoading(!1)})}onStartAddAction(){this.ref=this.dialogService.open(X,{header:"Agregar Banco",closable:!0,height:"50dvh",width:"50dvh"}),this.ref.onClose.pipe(L(this.destroy$)).subscribe(e=>{e?.success&&e.value&&this.loadBanks(),this.ref=null})}onEdit(e){this.ref=this.dialogService.open(Z,{data:{bank:e},header:"Editar Banco",closable:!0,height:"60dvh",width:"50dvh"}),this.ref.onClose.pipe(L(this.destroy$)).subscribe(t=>{t?.success&&this.loadBanks(),this.ref=null})}onDelete(e){e?.id&&this.confirmationService.confirm({message:`\xBFEst\xE1s seguro de que quer\xE9s eliminar el banco <b>${e.name}</b>? Esta acci\xF3n no se puede deshacer.`,header:"Eliminar Banco",icon:"pi pi-trash",acceptLabel:"Eliminar",rejectLabel:"Cancelar",acceptButtonStyleClass:"p-button-danger custom-confirm-btn",rejectButtonStyleClass:"p-button-secondary custom-cancel-btn",accept:()=>{this.uiService.setLoading(!0),this.appService.bankApiService.deleteBank(e.id).pipe(L(this.destroy$)).subscribe({next:()=>{this.uiService.showSuccess("Eliminado",`${e.name} fue eliminado correctamente.`),this.loadBanks()},error:t=>this.uiService.showError("Error al eliminar",t.error?.message||"No se pudo eliminar el banco"),complete:()=>this.uiService.setLoading(!1)})}})}onListAction(e){switch(e.type){case"edit":this.onEdit(e.value);break;case"delete":this.onDelete(e.value);break;default:console.warn("Acci\xF3n no reconocida:",e.type)}}static \u0275fac=function(t){return new(t||r)(p(I),p(xe),p(ue),p(N))};static \u0275cmp=v({type:r,selectors:[["app-bank-page"]],decls:9,vars:7,consts:[["tableContent",""],[2,"display","flex","justify-content","space-between","align-items","center","margin-bottom","1rem"],["icon","pi pi-plus","label","Agregar","styleClass","p-button-outlined p-button-plain",3,"click","disabled"],[4,"ngIf","ngIfElse"],[2,"display","flex","justify-content","center","align-items","center","height","50vh"],["strokeWidth","4"],[3,"list","action",4,"ngIf"],[3,"action","list"]],template:function(t,o){if(t&1){let m=R();n(0,"div",1)(1,"h1"),l(2,"Bancos"),i(),n(3,"p-button",2),f(4,"async"),u("click",function(){return y(m),E(o.onStartAddAction())}),i()(),d(5,Qe,3,0,"ng-container",3),f(6,"async"),d(7,Ze,2,3,"ng-template",null,0,ce)}if(t&2){let m=pe(8);s(3),c("disabled",$(4,3,o.loading$)),s(2),c("ngIf",$(6,5,o.loading$))("ngIfElse",m)}},dependencies:[Q,de,T,k,B,P,O,w,A,S,D,F,h,q,Ce,Ee],encapsulation:2})};export{je as BankPage};
